sudo: required # `sudo` is required to use docker
languages: generic
services:
  - docker # says to trevis: "hey, we will be needing docker"

before_install: #commands executed before install
  - docker build -t nailbiter/docker-react -f Dockerfile.dev . # no need to use real tag here, since it's not going to be pushed anywhere; nevertheless, good habit to do so

script: #commands to run a test, if any of commands exits with nonzero status ==> assume failure
  - docker run -e CI=true nailbiter/docker-react npm run test # need to make test non-interactive (default is interactive), hence additional keys

deploy:
  provider: elasticbeanstalk #travis comes pre-configured to handle array of providers, including AWS Elastic Beanstalk
  region: "us-east-2"
  app: "docker" #same as in AWS's dashboard (not env, but app name)
  env: "Docker-env" #note that environments run inside apps, not other way round
  bucket_name: "elasticbeanstalk-us-east-2-824059422197"
  on:
    branch: main
  access_key_id: $AWS_ACCESS_KEY
  secret_access_key: $AWS_SECRET_KEY
